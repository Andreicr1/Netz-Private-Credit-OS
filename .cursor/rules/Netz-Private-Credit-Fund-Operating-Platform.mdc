---
alwaysApply: true
---

You are an engineering agent building an institutional-grade Portfolio & Governance Platform
for the Netz Private Credit Fund.

This is NOT a generic software project.
This is a regulated private credit operating system with auditability, compliance discipline,
and investor-grade reporting.

You must follow these rules strictly.

---

## 1. Product Scope & Philosophy

This platform is a multi-tenant Private Credit Operating System, not a dev tool.

Core modules:

1. Portfolio Monitoring (primary MVP)
2. Compliance & Regulatory Document Control (CIMA-first)
3. Reporting Automation (monthly investor-grade drafts)
4. Investor Q&A with RAG + citations
5. Deal Intake & Investment Pipeline ("Esteira de Análise")

The application must enforce process discipline and institutional governance.

Never implement "chatbot-first" UX.
This is a workflow-driven governance platform.

---

## 2. Architecture Requirements

### Frontend
- Web application (React + Next.js preferred)
- Professional institutional UI (not developer-style boards)
- Role-based views: GP, Compliance, Auditor, Investor

### Backend
- FastAPI (Python) or .NET modular services
- All business logic lives in the backend
- Frontend never accesses Blob/Search/OpenAI directly

### Storage
- Azure Blob Storage = canonical document repository
- Versioning enabled
- Immutability/WORM-ready for finalized documents

### Structured Data
- Azure SQL (preferred) for portfolio + governance entities

### Search & RAG
- Azure AI Search for document retrieval
- GPT-5.2-chat for interpretation, explanation, and drafting
- All AI answers must include citations to source documents

### Workflow Engine
- Azure Functions / Logic Apps run as invisible infrastructure
- Users never interact with workflow tools directly

---

## 3. Multi-Tenant Rules

Tenant = Fund.

All entities must include:

- fund_id
- access_level
- audit metadata

Never mix data across funds.
Prefer one Search Index + one Blob Container per fund.

---

## 4. Institutional Governance Standards

This system must be audit-ready:

- Every decision must be logged
- Every document must be versioned
- Every AI output must store:
  - prompt context
  - retrieved sources
  - model version
  - timestamp

No black-box approvals.
AI assists, explains, drafts — never "decides".

---

## 5. Deal Intake & Investment Pipeline Rules

The platform must include a structured deal pipeline:

Stages:

- Intake
- Qualification Gate (automatic reject/flag rules)
- Initial Review
- Underwriting
- IC Memo Draft
- Investment Committee Decision
- Execution / Closing
- Archive (Rejected deals remain permanently stored)

All rejected deals must have:

- rejection_reason_code
- rejection_rationale (short, technical)

Qualification must eliminate non-mandate deals automatically.

This module is mandatory.

---

## 6. Compliance Module Rules (CIMA-first)

Compliance obligations must be represented explicitly:

- required document types
- periodicity
- expiry dates
- evidence status

The system must generate alerts for:

- missing documents
- outdated policies
- regulatory reporting deadlines

---

## 7. Portfolio Monitoring Rules (Highest Priority)

Portfolio Monitoring is the core MVP.

Must support:

- loan-level exposure tracking
- concentration limits
- covenant breach detection
- maturity & liquidity timelines
- automated alerts -> Actions

No portfolio analytics should depend on PDFs.
All critical metrics must live in structured DB tables.

---

## 8. Actions & Execution Layer

The platform includes an internal execution/action tracking layer:

- Actions are created by workflows, compliance gaps, or IC decisions
- Actions require evidence and review
- Status model must be institutional:

  Open → In Progress → Pending Evidence → Under Review → Closed

Never use Scrum language (sprints, story points).

---

## 9. Coding & Implementation Standards

- Prefer clean modular design
- Avoid monolithic files
- Use explicit schemas (Pydantic / ORM models)
- Every endpoint must enforce RBAC
- No hardcoded secrets (use Azure Key Vault)

Documentation must be professional, concise, audit-friendly.

---

## 10. Output Expectations

When implementing features:

1. Start with database schema + domain models
2. Implement backend API endpoints
3. Add workflow triggers if needed
4. Build frontend UI last
5. Always ensure traceability and compliance logging

Never skip governance requirements for speed.

---

## 11. Non-Negotiable Constraints

- No AI-generated decisions without human approval
- No cross-fund data leakage
- No direct OpenAI calls from frontend
- No dev-style backlog UI exposed to investors
- Everything must be explainable and auditable

---

## Guiding Principle

Build this as if a Big4 auditor and a CIMA regulator will inspect it.
Because they will.

Institutional quality > speed.
Governance > convenience.
Evidence > opinions.
